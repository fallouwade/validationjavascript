<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Page  Accueil</title>
    <link rel="stylesheet" href="styles.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
<!--  -->



    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
    
    <button class=" d-lg-none bg-white position-fixed shadow-lg border-0" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasResponsive" aria-controls="offcanvasResponsive"><i class="bi bi-list fs-1 "></i></button>

        <div  class="offcanvas-lg offcanvas-end sidebar" tabindex="-1" id="offcanvasResponsive" aria-labelledby="offcanvasResponsiveLabel">
            <div class="offcanvas-header">
                <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#offcanvasResponsive" aria-label="Close"></button>
              </div> 
            <div class="offcanvas-body couleur-bg">
                <ul> 

    
                    <h4 class=" text-white fw-bold my-3 d-flex align-items-center" >
                        <img src="/image/Savings.png" class="px-1" alt="">
                        Bakéli Tontinee
                    </h4> 
        
                    <li>
                        
                        <a href="#home" class="text-white fs-6 fw-semibold" onclick="showSection('home')">
                            <img src="/image/category.png" alt="">
                            Accueil
                        </a>
                    </li>
                    <li>
                        <a href="#utilisateurs" class="text-white fs-6 fw-semibold" onclick="showSection('utilisateurs')">
                            <img src="/image/user.png" alt="">
                            Utilisateurs
                        </a>
                    </li>
                    <li>
                        <a href="#cotisations" class="text-white fs-6 fw-semibold " onclick="showSection('cotisations')">
                            <img src="/image/healthicons_money-bag-outline.png" alt="">
                            Cotisations
                        </a>
                    </li>
                    <li>
                        <a href="#parametres" class="text-white fs-6 fw-semibold" onclick="showSection('parametres')">
                            <img src="/image/Vector.png" alt="">
                            <div class="btn-group">
                                <button type="button" class="btn text-white  fs-6 fw-semibold border border-0 dropdown-toggle" onclick="sectionParametre('pageAcceuiParametre')"  data-bs-toggle="dropdown" data-bs-display="static" data-bs-auto-close="false" aria-expanded="false">
                                  Parametres
                                </button>
                                <ul class="dropdown-menu g-0 bg text-white dropdown-menu-end dropdown-menu-lg-start border border-0">
                                  <li><button  class="dropdown-item text-white m-0 p-0" onclick="sectionParametre('parametresgeneraux')" type="button">Parametre generaux</button></li>
                                  <li><button  class="dropdown-item text-white m-0 p-0" onclick="sectionParametre('utilisateur2')" type="button">Utilisateurs</button></li>
                                  <li><button  class="dropdown-item text-white m-0 p-0" onclick="sectionParametre('archives')" type="button">Archives</button></li>
                                  <li><button  class="dropdown-item text-white m-0 p-0" onclick="sectionParametre('MembresBloquer')" type="button">Membres Bloques</button></li>
                                </ul>
                              </div>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    

    <div id="content" class="p-0">
        <!-- Dashboard -->
        <div id="home" class="section m-0">
            <div class="bg-white white p-3 shadow-lg  d-flex  align-items-center">
                <div class="none">
                    <span class="fw-bold fs-5">Admin Dashboard</span>
                </div>
                <div class="d-flex align-items-center">
                    <div class="me-3"><i class="bi bi-bell"></i></div>
                    <div class="d-flex">
                        <div>
                             <img src="/image/Ellipse 9.png" alt="Admin">
                        </div>
                        <div>
                            <span class="fw-semibold">Ndiaga Sall</span> <br>
                            <span class="text-secondary">Adminitrator</span>
                        </div>
                    </div>

                    <div>
                        <div class="btn-group non">
                            <button type="button" class="btn btn-secondary border border-0 dropdown-toggle bg-white text-dark" data-bs-toggle="dropdown" data-bs-display="stati" aria-expanded="false">
                              
                            </button>
                            <ul class="dropdown-menu   dropdown-menu-lg-end ">
                                
                              <li><button class="dropdown-item text-secondary text-center" type="button">Profil</button></li>
                              <li><button class="dropdown-item text-secondary text-center" type="button">Mot de Passe</button></li>
                              <li><button class="dropdown-item text-secondary text-center" type="button">Déconnexion</button></li>
                            </ul>
                          </div>
                    </div>
                </div>
            </div>

            <!-- parties des cards -->

            <div class="container  px-5  my-3">
                <div class="row d-flex justify-content-between  gy-3   ">
                    <div class="col-12 col-md-6 col-lg-3  d-flex justify-content-center">
                        <div class="card" style="width: 15rem;">
                            <div class="card-body ">
                              <h5 class="card-title"></h5>
                              <h6 class="card-subtitle mb-2 text-body-secondary">Juin</h6>
                              <p class="card-text fw-bold">200000</p>
                              <h6 class="card-subtitle mb-2 text-body-secondary">
                                Nombres de cotisation: <span>0</span>
                            </h6>
                            </div>
                          </div>
                    </div>
                    <div class="col-12 col-md-6 col-lg-3 d-flex justify-content-center">
                        <div class="card " style="width: 15rem;">
                            <div class="card-body">
                              <h5 class="card-title"></h5>
                              <h6 class="card-subtitle mb-2 text-body-secondary">Juin</h6>
                              <p class="card-text fw-bold">200000</p>
                              <h6 class="card-subtitle mb-2 text-body-secondary">
                                Nombres de cotisation: <span>0</span>
                            </h6>
                            </div>
                          </div>
                    </div>
                    <div class="col-12 col-md-6 col-lg-5 d-flex justify-content-center">
                        <div class="card w-100 d-flex justify-content-center align-items-center flex-row px-2 " style="width: 18rem;">
                            <div><img src="/image/Savings.png" class="img-sac rounded" alt="img sac"></div>
                            <div class="card-body">
                              <h5 class="card-title"></h5>
                              <h6 class="card-subtitle mb-2 text-body-secondary">Caisse</h6>
                              <p class="card-text fw-bold">
                                
                                200000
                              </p>
                              <h6 class="card-subtitle mb-2 text-body-secondary">
                                Nombres de cotisation: <span>0</span>
                            </h6>
                            </div>
                          </div>
                    </div>
                </div>
            </div>

            <!-- Partie ou se trouve les diagammes -->
            <div class="container my-3 px-5">
                <div class="row gy-3">
                    <div class="col-12 col-md-6 col-lg-7">
                        <div class="card  h-100">
                            <div class="card-header fw-semibold">
                                Evaluation des cotisations en fonction du temps
                            </div>
                            <div class="card-body">
                                <canvas id="myChartt" style="width:100%; max-width:600px " ></canvas>
                            </div>
                          </div>
                    </div>
                    <div class="col-12 col-md-6 col-lg-5 ">
                        <div class="card h-100">
                            <div class="card-header fw-semibold">
                                Statistiques
                            </div>
                            <div class="card-body  ">
                              <canvas id="myChart" style="width:100% ;  max-width:600px;"></canvas>
                            </div>
                          </div>
                    </div>
                </div>
            </div>
        </div>




        <!-- Utilisateurs -->
        <div id="utilisateurs" class="section" style="display:none;">
            <div class="bg-white white p-3 shadow-lg  d-flex  align-items-center">
                <div class="none">
                    <span class="fw-bold fs-5">Utilisateurs</span>
                </div>
                <div class="d-flex align-items-center">
                    <div class="me-3"><i class="bi bi-bell"></i></div>
                    <div class="d-flex">
                        <div>
                             <img src="/image/Ellipse 9.png" alt="Admin">
                        </div>
                        <div>
                            <span class="fw-semibold">Ndiaga Sall</span> <br>
                            <span class="text-secondary">Adminitrator</span>
                        </div>
                    </div>

                    <div>
                        <div class="btn-group non">
                            <button type="button" class="btn btn-secondary border border-0 dropdown-toggle bg-white text-dark" data-bs-toggle="dropdown" data-bs-display="stati" aria-expanded="false">
                              
                            </button>
                            <ul class="dropdown-menu   dropdown-menu-lg-end ">
                                
                              <li><button class="dropdown-item text-secondary text-center" type="button">Profil</button></li>
                              <li><button class="dropdown-item text-secondary text-center" type="button">Mot de Passe</button></li>
                              <li><button class="dropdown-item text-secondary text-center" type="button">Déconnexion</button></li>
                            </ul>
                          </div>
                    </div>
                </div>
            </div>
           
            <div>
                <div class="container mt-4  ps-5 pe-5 ">
                  <div class="row row-cols-1 row-cols-md-3 ps-5 pe-5">
                      <div class="col">
                        <div class="card bg1 text-white shadow">
                          <div class="card-body">
                            <p class="card-title">Membre actif <i class="bi bi-circle-fill"></i></p>
                            <h5>
                                <label>94</label>
                                Membres
                            </h5>
                            
                          </div>
                        </div>
                      </div>
                      <div class="col">
                        <div class="card shadow">
                          <div class="card-body">
                           <p class="card-title">Membre Bloqué <i class="bi bi-ban text-danger"></i></p>
                            <h5>
                                <label>6</label>
                                Membres
                            </h5>
                            
                          </div>
                        </div>
                      </div>
                      <div class="col">
                        <div class="card shadow">
                          <div class="card-body">
                            <p class="card-title">Total Effectif</p>
                            <h5>
                                <label>100</label>
                                Membres
                            </h5>
                           
                          </div>
                        </div>
                      </div>
                      </div>
                      <div class="mt-5 d-flex justify-content-end ">
                          <button type="button" class="btn btn-primary fw-medium bg-black mb-2" data-bs-toggle="modal" id="modal1" data-bs-target="#exampleModal">
                               Ajouter
                           </button>
                      </div>
                        

                         <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                          <div class="modal-dialog">
                            <div class="modal-content">
                              <div class="modal-header">
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                              </div>
                              <div class="modal-body">    
                                <div class=" container ">
                                
                                <form id="form" method="post">
                                <div class="">
                                        <div class="d-flex container gap-5">
                                            <div class="mb-2 col-5">
                                                 <label for="exampleFormControlInput1"  class="form-label fw-medium">Nom</label>
                                                 <input type="text" class="form-control" required id="membre_prenom" >
                                            </div>
                                            <div class="mb-2 col-5">
                                                 <label for="exampleFormControlInput1" class="form-label fw-medium">Prénom</label>
                                                 <input type="text" class="form-control " required id="membre_nom">
                                            </div>
                                        </div>

                                        <div class="d-flex container gap-5">
                                            <div class="mb-2 col-5">
                                                 <label for="exampleFormControlInput1"  class="form-label fw-medium">Date de naissance</label>
                                                 <input type="date" class="form-control" required id="membre_naissance" >
                                            </div>
                                            <div class="mb-2 col-5">
                                                 <label for="exampleFormControlInput1" class="form-label fw-medium">Profession</label>
                                                 <input type="text" class="form-control " required id="membre_profession">
                                            </div>
                                        </div>
                                        <div class="d-flex container gap-5">
                                            <div class="mb-2 col-5">
                                                 <label for="exampleFormControlInput1"  class="form-label fw-medium">E-mail</label>
                                                 <input type="email" class="form-control" required id="membre_email" >
                                            </div>
                                            <div class="mb-2 col-5">
                                                 <label for="exampleFormControlInput1" class="form-label fw-medium">Téléphone</label>
                                                 <input type="number" class="form-control " required id="membre_telephone">
                                            </div>
                                        </div>

                                        <div class="d-flex container gap-5">
                                            <div class="mb-2 col-5">
                                                 <label for="exampleFormControlInput1"  class="form-label fw-medium">Adresse</label>
                                                 <input type="text" class="form-control" required id="membre_adresse" >
                                            </div>
                                            <div class="mb-2 col-5">
                                                 <label for="exampleFormControlInput1" class="form-label fw-medium">Organisation</label>
                                                 <input type="text" class="form-control " required id="membre_organisation">
                                            </div>
                                        </div>

                                         <div class="d-flex container justify-content-center">
                                            
                                            <div class=" col-8">
                                                 <label for="exampleFormControlInput1" class="form-label fw-medium">Seuil</label>
                                                 <input type="number" class="form-control " required id="membre_seuil">
                                            </div>
                                        </div>

                                      
                                    </div>
                                </form>
                                </div>
                              
                              </div>
                              <div class="modal-footer d-flex justify-content-center" id="footer">
                                
                                <button type="button" class="btn btn-primary col-5" data-bs-dismiss="modal" id="btn_ajou_membre">Ajouter</button>      

                              </div>
                            </div>
                          </div>
                        </div>
                    </div>
                        
                            <!-- Tableaux partie utilisateur -->
                    <div class="container col-11  ">
                    <table class="table ms-1 shadow-sm col-12 " id="table">
                         <thead class="rounded-1 " >
                            <tr class="table-success">
                              
                              <th scope="col" >Membres</th>
                              <th scope="col">Date début</th>
                              <th scope="col">Seuil</th>
                              <th scope="col">Progression</th>
                              <th scope="col">Statut</th>
                              <th scope="col">Actions</th>
                            </tr>
                          </thead>
                            <tbody id="body" class="rounded-5">
                                    
                                    <!-- DONNEE RECUP2RER SUR FIREBASE -->
                                                  
                            </tbody>
                    </table>
                    </div>
                     <nav aria-label="..." class="pt-4" >
                      <ul class="pagination d-flex justify-content-center ">
                        <li class="page-item disabled ">
                          <span class="page-link border-0 bg-white txt-black">Previous page</span>
                        </li>
                        <div class="d-flex gap-1 mt-2" id="pagination">
                            <li class="page-item"><a class="page-link rounded-pill shadow-sm text-black" href="#">1</a></li>
                            <li class="page-item"><a class="page-link rounded-pill shadow-sm text-black" href="#">2</a></li>
                            <li class="page-item"><a class="page-link rounded-pill shadow-sm text-black" href="#">3</a></li>
                        </div>
                        <li class="page-item border-0">
                          <span class="page-link text-black border-0 bg-white ">Next page</span>
                        </li>
                      </ul>
                    </nav>
            </div>

        
        </div>


        <!-- Cotisations -->


        <div id="cotisations" class="section" style="display:none;">
            <div class="bg-white white p-3 shadow-lg  d-flex  align-items-center">
                <div class="none">
                    <span class="fw-bold fs-5">Cotisations</span>
                </div>
                <div class="d-flex align-items-center">
                    <div class="me-3"><i class="bi bi-bell"></i></div>
                    <div class="d-flex">
                        <div>
                             <img src="/image/Ellipse 9.png" alt="Admin">
                        </div>
                        <div>
                            <span class="fw-semibold">Ndiaga Sall</span> <br>
                            <span class="text-secondary">Adminitrator</span>
                        </div>
                    </div>

                    <div>
                        <div class="btn-group non">
                            <button type="button" class="btn btn-secondary border border-0 dropdown-toggle bg-white text-dark" data-bs-toggle="dropdown" data-bs-display="stati" aria-expanded="false">
                              
                            </button>
                            <ul class="dropdown-menu   dropdown-menu-lg-end ">
                                
                              <li><button class="dropdown-item text-secondary text-center" type="button">Profil</button></li>
                              <li><button class="dropdown-item text-secondary text-center" type="button">Mot de Passe</button></li>
                              <li><button class="dropdown-item text-secondary text-center" type="button">Déconnexion</button></li>
                            </ul>
                          </div>
                    </div>
                </div>
            </div>
            <div class="container mt-4">

                <div class="row row-cols-1 row-cols-md-3 ps-5 pe-5">
                      <div class="col">
                        <div class="card bg1 text-white shadow">
                          <div class="card-body">
                            <p id="para_moi" style="line-height: 1;"></p>
                          
                                <label id="montant_dernier_moi" class="fw-bold fs-5"></label>
                            
                            
                            
                          </div>
                        </div>
                      </div>
                      <div class="col">
                        <div class="card shadow" id="display_card">
                          <div class="card-body">
                           <p  id="para_amoi" style="line-height:1"></p>
                         
                                <label id="montant_adernier_moi" class="fw-bold fs-5"></label>
                                
                            
                            
                          </div>
                        </div>
                      </div>
                      <div class="col">
                        <div class="card shadow">
                          <div class="card-body">
                            <p class="card-title" style="line-height:1">Total Caisse</p>
                        
                                <label id="total_caisse" class="fw-bold fs-5" style="line-height:1"></label>
                               
                         
                            <div >
                                <small class="progress" role="progressbar" aria-label="Success example" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">
                                    <small class="progress-bar bg-success" style="width: 0%" id="progress_bar"></small>

                                 </small> 
                                  <small class="d-flex justify-content-end" id="seuil_pourcentage" >0%</small>
                            </div>
                           
                          </div>
                        </div>
                      </div>
                      </div>
                  
            </div>
            <div>
                 <div class="container col-11 mt-3 ">
                    <table class="table ms-1 shadow-sm col-12 " id="table">
                         <thead class="rounded-1 " >
                            <tr class="table-success">
                              
                              <th scope="col" >Membres</th>
                              <th scope="col">Date début</th>
                              <th scope="col">Montant cotisé</th>
                              <th scope="col">Montant restant</th>
                              <th scope="col">Actions</th>
                            </tr>
                          </thead>
                            <tbody id="body1" class="rounded-5">
                               
                                    
                            </tbody>
                    </table>
                    </div>
                     <nav aria-label="..." class="pt-3" >
                      <ul class="pagination d-flex justify-content-center ">
                        <li class="page-item disabled ">
                          <span class="page-link border-0 bg-white txt-black">Previous page</span>
                        </li>
                        <div class="d-flex gap-1 mt-2" id="pagination">
                            <li class="page-item"><a class="page-link rounded-pill shadow-sm text-black" href="#">1</a></li>
                            <li class="page-item"><a class="page-link rounded-pill shadow-sm text-black" href="#">2</a></li>
                            <li class="page-item"><a class="page-link rounded-pill shadow-sm text-black" href="#">3</a></li>
                        </div>
                        <li class="page-item border-0">
                          <span class="page-link text-black border-0 bg-white ">Next page</span>
                        </li>
                      </ul>
                    </nav>
                
            </div>
        </div>


        <!-- MODAL POUR CTISER -->
        <div class="modal fade" id="exampleModal1" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-dialog-scrollable">
            <div class="modal-content">
              <div class="modal-header">
                <h1 class="modal-title fs-5" id="exampleModalLabel">Modal title</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <div class="mb-3 col-4">
                    <label for="exampleFormControlInput" class="form-label fw-medium">Montant à cotiser</label>
                    <input type="number" class="form-control " required id="cotiser">
                 </div>
              </div>
              <div class="modal-footer">
               
                <button type="button" class="btn btn-primary" id="valider_cotisation" data-bs-dismiss="modal">Valider</button>
              </div>
            </div>
          </div>
        </div>
        <!-- MODAL POUR VOIR SUR PARTIE COTISATION -->

    <!--     
        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
          Launch demo modal
        </button> -->

        <!-- Modal -->
        <div class="modal fade" id="exampleModal2" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div  class="modal-dialog modal-dialog-scrollable">
            <div class="modal-content">
              <div class="modal-header bg-success p-0">
                <p class="modal-title ps-4 " id="exampleModalLabel">Détail Cotisation</p>
                <!-- <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button> -->
              </div>
              <div class="modal-body" >
                 <div class="container col-11 mt-3 ">
                    <table class="table ms-1 shadow-sm col-12 " id="table">
                        <div class=" ">
                            <strong id="voir_nom" class="fw-bold fs-5 p-0">fallou</strong><br>
                            <small id="voir_profession" class=" text-muted p-0 text-center ps-5"></small>
                        </div>
                         <thead class="rounded-1 " >
                            <tr class="table-dark gx-3 text-center">
                              
                              <th scope="col" >Mois</th>
                              <th scope="col">Date</th>
                              <th scope="col">Montant</th>
                             
                            </tr>
                          </thead>
                            <tbody id="voir" class="rounded-5">
                               
                                    
                            </tbody>
                    </table>
                 </div>
             
              </div>
              <div class="modal-footer container">
            
                <p id="voir_total" class="fw-bold fs-5 me-4 p-2"></p>
              </div>
            </div>
          </div>
        </div>


        <!-- Parametres -->
        <div id="parametres" class="section" style="display:none;">
            <div class="bg-white white p-3 shadow-lg  d-flex  align-items-center">
                <div class="none">
                    <span class="fw-bold fs-5">
                        Parametres
                    </span>
                    
                </div>
                <div class="d-flex align-items-center">
                    <div class="me-3"><i class="bi bi-bell"></i></div>
                    <div class="d-flex">
                        <div>
                             <img src="/image/Ellipse 9.png" alt="Admin">
                        </div>
                        <div>
                            <span class="fw-semibold">Ndiaga Sall</span> <br>
                            <span class="text-secondary">Adminitrator</span>
                        </div>
                    </div>

                    <div>
                        <div class="btn-group non">
                            <button type="button" class="btn btn-secondary border border-0 dropdown-toggle bg-white text-dark" data-bs-toggle="dropdown" data-bs-display="stati" aria-expanded="false">
                              
                            </button>
                            <ul class="dropdown-menu   dropdown-menu-lg-end ">
                                
                              <li><button class="dropdown-item text-secondary text-center" type="button">Profil</button></li>
                              <li><button class="dropdown-item text-secondary text-center" type="button">Mot de Passe</button></li>
                              <li><button class="dropdown-item text-secondary text-center" type="button">Déconnexion</button></li>
                            </ul>
                          </div>
                    </div>
                </div>
            </div>
            <div id="pageAcceuiParametre"  class="section2 p-5 bg-light" >
                <h1>Parametre Generaux 1</h1>
                <div class="container mt-3 bg-white p-3">
                  <div class="row">
                    <div class="col-12 col-md-5">
                      <div class="row">
                        <div class="col">
                          <div class=" text-center">
                            <p class="text-lit fw-bold ">profil</p>
                            <img src="/image/Ellipse 9.png" alt="" class="rounded-circle img-profile w-75">
                        </div>
                        <div class="row  text-center">
                            <h3 class="text-center mx-3 vert">Ndiagua Sall</h2>
                            <h5 class="mx-2 vert">Admin</h5> 
                        </div>
                        </div>
                        <div class="col">
                          <div class="trait mx-5"><div class="trai1"></div></div>
                        </div>
                      </div>
                    </div>
                    <div class="col-12 col-md-7">
                      <form class="row g-3 me-5">
                        <div class="col-md-6">
                          <label for="prenom" class="form-label">Prénom</label>
                          <input type="text" class="form-control" id="inputPrenom" required>
                        </div>
                        <div class="col-md-6">
                          <label for="Nom" class="form-label">Nom</label>
                          <input type="text" class="form-control" id="inputNom" required>
                        </div>
                        <div class="col-md-12">
                          <label for="phone" class="form-label">Téléphone</label>
                          <input type="text" class="form-control" id="inputPhone" required>
                        </div>
                        <div class="col-md-12">
                            <label for="E-mail" class="form-label">E-mail</label>
                            <input type="text" class="form-control" id="inputEmail" required>
                        </div>
                        <div class="col-md-12">
                          <label for="Statut" class="form-label">Statut</label>
                          <input type="text" class="form-control" id="inputStatut" placeholder="Administrateur" required>
                        </div>
                        <div class="col-12">
                            <button class="btn text-white MJ p-1" type="submit" id="btn-jour">Mettre à jour</button>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
            </div>
            <div id="content2">
                <!-- Parametres Generaux -->
                 <div id="parametresgeneraux" class="section2 p-5 bg-light">
                    <h1>Parametre Generaux</h1>
                    <div class="container p-3 bg-white">
                      <div class="row">
                        <div class=" col-12 col-md-4 ">
                          <div class="row">
                            <div class="col">
                              <div class=" text-center">
                                <p class="text-lit fw-bold  ">profil</p>
                                <img src="/image/Ellipse 9.png" alt="" class="rounded-circle img-profile w-50">
                            </div>
                            <div class="row  text-center">
                                <h2 class="text-center mx-3 vert" id="info5">Ndiagua Sall</h2>
                                <h5 class="mx-2 vert" id="info6">Admin</h5>
                                <br>
                                <br>
                                <!-- ------modal-edifier------- -->

                                <button type="button " class=" mx-5 MJ  btn p-0 w-75">
                                    <a href="#" class="text-white">Editer profil</a>
                                  </button>
                                  
                            </div>
                        </div>
                        <div class="col-md-2 text-center" id="admin">
                            <div class="trait mx-3"><div class="trai1"></div></div>
                        </div>
                            </div>
                            <div class="col"></div>
                          </div>
                       
                        <div class="col-12 col-md-8">
                                <!-- -------------info--------------- -->
                                 <div class="row">
                                    <h6 class=" fw-bold vert-claire">Informations Générals</h6>
                                 </div>
                                <div
                                    class="row  border-bottom pt-3">
                                    <div class="col-md-8">Prénom
                                    </div>
                                    <div class="col-md-4 text-center"><p id="info1">Ndiagua</p></div>
                                </div>
                                <div
                                    class="row border-bottom pt-3">
                                    <div class="col-md-8">Nom
                                    </div>
                                    <div class="col-md-4 text-center"><p id="info2">Sall</p></div>
                                </div>
                                <div
                                    class="row border-bottom pt-3">
                                    <div class="col-md-8">Statut
                                    </div>
                                    <div class="col-md-4 text-center"><p id="info3">Administrateur</p></div>
                                </div>
                                <div
                                class="row  pt-3">
                                <div class="col-md-8">E-mail
                                </div>
                                <div class="col-md-4 text-center"><p id="info4">ndiagua@gmail.com</p></div>
                            </div>


                                <!-- --------statistique------- -->
                                 <div class="row">
                                    <h6 class=" fw-bold  vert-claire mt-2 border-bottom ">Statistiques</h6>

                                 </div>
                                <div
                                    class="row  border-bottom pt-3">
                                    <div class="col-md-8"><p>Nombre de membre ajoutés</p>
                                    </div>
                                    <div class="col-md-4 text-center">25</div>
                                </div>
                                <div
                                    class="row border-bottom pt-3">
                                    <div class="col-md-8">Nombre de membre archivés
                                    </div>
                                    <div class="col-md-4 text-center">10</div>
                                </div>
                                <div
                                    class="row  pt-3">
                                    <div class="col-md-8">Nombre de membre bloqués
                                    </div>
                                    <div class="col-md-4 text-center">4</div>
                                </div>
                        </div>
                      </div>
                      </div>
                    </div>
                 </div>

                 <!-- Parties Utilisateur 2 -->
                 <div id="utilisateur2" class="section2 p-5 bg-light">
                    <h1>Utilisateurs</h1>
                    <div class="container bg-white">
                      <div class="row">
                        <div class="col">
                          <h4>Membre</h4>
                          <div class="row">
                              <div class="col-12 col-md-5">
                                  <table class="table  no-border ">
                                      <tbody>
                                          <tr>
                                              <td>Selena Roy</td>
                                          </tr>
                                          <br>
                                          <br>
                                          <tr>                           
                                           <td>Emma Watson</td>
                                          </tr>
                                          <tr>                       
                                          <td>Jhon Robert</td>
                                      </tr>
                                      <tr>
                                          <td>Anne Hathaway</td>
                                      </tr>
                                      <tr>
                                          <td>Ravi Shankar</td>
                                      </tr>
                                      <tr>
                                          <td>Emma Stone</td>
                                      </tr>
                                      <tr>
                                          <td>Floyd Miles</td>
                                      </tr>
                                      <tr>
                                          <td>Janne cooper</td>
                                      </tr>
                                      </tbody>
                                  </table>
                              </div>
                              <div class="col-md-2 text-center" id="admin">
                                  <div class="trait mx-5"><div class="trai1"></div></div>
                              </div>
                          </div>
                        </div>
                        <div class="col-12 col-md-7">
                          <h3>Information General</h3>
                          <form action="" class="p-2">
                              <div class="row g-3">
                                  <div class="col-md-6">
                                      <label for="Nom"  class="form-label">Nom</label><br>
                                      <input type="text" class="form-control" placeholder="Roy" required>
                                  </div>
                                  <div class="col-md-6">
                                      <label for="Nom"  class="form-label">Prenom</label><br>
                                      <input type="text" class="form-control"placeholder="Selena" required>
                                  </div>
                              </div>
                              <div class="row g-3">
                                  <div class="col-md-6">
                                      <label for="Naissance"  class="form-label">Date de naissance</label><br>
                                      <input type="date" class="form-control" placeholder="jj/mm/aa" required >
                                  </div>
                                  <div class="col-md-6">
                                      <label for="Profession"  class="form-label">Profession</label><br>
                                      <input type="text" class="form-control" placeholder="Designer">
                                  </div>
                              </div>
                              <div class="row g-3">
                                  <div class="col-md-6">
                                      <label for="passe"  class="form-label">Definir Mot de pass</label><br>
                                      <input type="password" class="form-control"placeholder="*******" required>
                                  </div>
                                  <div class="col-md-6">
                                      <label for="confirme"  class="form-label">Confirmer mot de passe</label><br>
                                      <input type="password" class="form-control"placeholder="*******"  required>
                                  </div>
                              </div>
                              <div class="row g-3">
                                  <div class="col-md-6">
                                      <label for="E-mail"  class="form-label">E-mail</label><br>
                                      <input type="email" class="form-control" placeholder="selenaroy98@gmail.com" required>
                                  </div>
                                  <div class="col-md-6">
                                      <label for="phone"  class="form-label">Téléphone</label><br>
                                      <input type="text" class="form-control" placeholder="+221 77 250 11 22" required >
                                  </div>
                              </div>
                              <div class="row g-3">
                                  <div class="col-md-6">
                                      <label for="Adress"  class="form-label">Adresss</label><br>
                                      <input type="text" class="form-control" placeholder="HLM grand yoff,Dakar" required>
                                  </div>
                                  <div class="col-md-6">
                                      <label for="organisation"  class="form-label">organisation</label><br>
                                      <input type="text" class="form-control"placeholder="volkeno" required >
                                  </div>
                              </div><br>
                              <button class="btn p-1 text-white mj ">Mettre a jour</button>
                          </form>
                        </div>
                      </div>
                      <!-- -------pagination---------- -->
                       <!-- <div class="box p-2">
                        <button type="button" class="btn text-black bg-success"><a href="#">Preview</a></button>
                        <button type="button" class="btn text-black bg-success"><a href="#">Next</a></button>
                       </div> -->
                    </div>
                 </div>

                 <!-- Parties Archives -->
                 <div id="archives" class="section2">
                    <h1>Archives</h1>
                    <div class="container">
                      
                        <p class="archives ps-5 fw-bold fs-5" id="para_archive"></p>
                        <table class="table ms-1 shadow-sm col-12">
                             <thead class="rounded-1 " >
                            <tr class="table-dark gx-3 text-center">
                              
                              <th scope="col" >Membres</th>
                              <th scope="col">Date début</th>
                              <th scope="col">Actions</th>
                             
                            </tr>
                          </thead>
                            <tbody id="archive" class="rounded-5">
                               
                                    
                            </tbody>
                    </table>
                        
                      
                    </div>
                 </div>

                 <!-- Parties Membres Bloques -->
                 <div id="MembresBloquer" class="section2">
                    <h1>Membres Bloques</h1>
                    <div class="container">
                     
                        <p class="bloqués" id="para_bloque"></p>
                       <table class="table ms-1 shadow-sm col-12">
                             <thead class="rounded-1 " >
                            <tr class="table-dark gx-3 text-center">
                              
                              <th scope="col" >Membres</th>
                              <th scope="col">Date début</th>
                              <th scope="col">Actions</th>
                             
                            </tr>
                          </thead>
                            <tbody id="bloque" class="rounded-5">
                               
                                    
                            </tbody>
                    </table>
                        
                      
                    </div>
                 </div>
            </div>
        </div>
    </div>
</body>

    <script src="script.js"></script>
    <script src="diagramme1.js"></script>
    <script src="diagramme2.js"></script>
    <script src="misajour.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>


<script type="module">
     import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
  import { getFirestore } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js";
import {collection, addDoc, getDocs,doc,deleteDoc, onSnapshot, updateDoc,arrayUnion} from "https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js";


const firebaseConfig = {
  apiKey: "AIzaSyCZypuK23zcCrMuOoMjlOKt5Ay7gQz8ZOc",
  authDomain: "validdationjs.firebaseapp.com",
  projectId: "validdationjs",
  storageBucket: "validdationjs.appspot.com",
  messagingSenderId: "609699792407",
  appId: "1:609699792407:web:84a8dbfcb4f6b8b33e7e52"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

                                                    

                                                    // PARTIE UTILISATEUR



    // Affichage des membre
let todo=[];
let todo1=[];
let todo2=[];
let todo3=[]
let currentPage = 1;
let itemsPerPage = 6;

function affichage_utilisateur() {
    let element = "";
    const start = (currentPage - 1) * itemsPerPage;
    const end = start + itemsPerPage;
    const paginatedItems = todo.slice(start, end);
    console.log(paginatedItems)



    paginatedItems.forEach(item => {

        if (item.progress_bar3>=100) {
            item.progress_bar3=100
        }
        console.log( item.id)
        element += `
            

            <tr > 
                <td>
                   ${item.prenom_nom} 
                                    
                 </td>
                 <td>
                  ${item.date_debut.date} 
                   </td><td>${item.seuil}</td>
                     <td style="display: table-cell;">
                        <div class="d-flex align-items-center gap-1 mt-1">
                            <small class="progress" role="progressbar" aria-label="Success example"  aria-valuemin="0" aria-valuemax="100">
                                <small class="progress-bar bg-success"  id="${item.id}" style="width:${item.progress_bar3}%" ></small>

                             </small> 
                              <small class="progress-percentage" >${item.progress_bar3}%
                              </small>
                        </div>
                      </td>
                      <td id="termine">${item.progression}</td>
                <td>
                     <div class="d-flex  align-items-center">
                        <button  type="button" class="border-0 m-0 p-1 bg-white"  >
                            <i class="bi bi-eye"></i>
                        </button>
                         <button type="button" class="border-0 m-0 p-1 bg-white" onclick="btn_archive('${item.id}')"  >
                            <i class="bi bi-archive" ></i>
                        </button>
                         <button type="button" class="border-0 m-0 p-1 bg-white"  onclick="btn_bloque('${item.id}')"   >
                             <i class="bi bi-ban "></i>
                        </button>
                     </div>
                </td>
             </tr>


        `;
    });
  

    body.innerHTML = element;

    
}


// Recuperation des données au niveau de firebase

//Recupération pour la partie Ajouter membre
const formulaire_membre = collection(db, "formulaire_ajouter");

//Recupération pour la partie Cotisation
const formulaire_cotisation = collection(db,"formulaire_cotiser")

const formulaire_archive= collection(db, "formulaire_archiv")
const formulaire_bloque= collection(db, "formulaire_bloque1")


async function recuperation_firebase() {

            try {

                //Recupération pour la partie Ajouter membre
                const snapshot = await getDocs(formulaire_membre);
                snapshot.docs.forEach(doc => {
                    todo.push({ ...doc.data(), id: doc.id });
                });


                //Recupération pour la partie Cotisation
                const snapshot1 = await getDocs(formulaire_cotisation);
                snapshot1.docs.forEach(doc => {
                    todo1.push({ ...doc.data(), id: doc.id });
                });

                // Recupération pour la partie Archive

                const snapshot2 = await getDocs(formulaire_archive);
                snapshot2.docs.forEach(doc => {
                    todo2.push({ ...doc.data(), id: doc.id });
                });

                // Rcuperation pour la partie bloque

                const snapshot3 = await getDocs(formulaire_bloque);
                snapshot3.docs.forEach(doc => {
                    todo3.push({ ...doc.data(), id: doc.id });
                });



                //Recupération pour la partie Ajouter membre

                onSnapshot(formulaire_membre, (snap) => {
                    todo = [];
                    snap.docs.forEach((doc) => {
                        todo.push({ ...doc.data(), id: doc.id });
                    });
                    affichage_utilisateur();
                });


                //Recupération pour la partie Cotisation
                onSnapshot(formulaire_cotisation, (snap) => {
                    todo1 = [];
                    snap.docs.forEach((doc) => {
                        todo1.push({ ...doc.data(), id: doc.id });
                    });
                    affichage_cotisation() 
                });

                //Recuperation pour la partie Archive
                    onSnapshot(formulaire_archive, (snap) => {
                    todo2 = [];
                    snap.docs.forEach((doc) => {
                        todo2.push({ ...doc.data(), id: doc.id });
                    });
                    affichage_archive() 
                    });

                        // Recupération pour la partie Bloque

                         onSnapshot(formulaire_bloque, (snap) => {
                    todo3 = [];
                    snap.docs.forEach((doc) => {
                        todo3.push({ ...doc.data(), id: doc.id });
                    });
                    affichage_bloque() 
                    });



            }
             catch (e) {
                console.error("Erreur: ", e);
            }
        }

        recuperation_firebase()


// Boutton Ajouter des membre au niveaux de firebase
      

btn_ajou_membre.onclick= async function (e){
    e.preventDefault()


let prenom_noms= membre_prenom.value + " " + membre_nom.value;
console.log(prenom_noms)
        const dateActuelle = new Date();
        const jour = dateActuelle.getDate();
        const moisIndex = dateActuelle.getMonth() + 1; // Les mois commencent à 0, donc on ajoute 1
        const annee = dateActuelle.getFullYear();
        const moisNoms = [
         "janvier", "février", "mars", "avril", "mai", "juin",
         "juillet", "août", "septembre", "octobre", "novembre", "décembre"
        ];
        const moi = moisNoms[moisIndex];
        let d= jour+"/"+moisIndex+"/"+annee;
        console.log(d)

                  try {
    // Ajouter des Membre
  addDoc(formulaire_membre,{
        prenom_nom:prenom_noms ,
        naissance: membre_naissance.value,
        profession: membre_profession.value,
        email: membre_email.value,
        telephone: membre_telephone.value,
        date_debut: {date: d, mois:moi}, 
        seuil: membre_seuil.value,
        progression: "En cours",
       
        adresse: membre_adresse.value,
        organisation: membre_organisation.value,
         progress_bar3:0,    
   });

  //Ajouter Cotisaton
 await addDoc(formulaire_cotisation,{
    prenom_nom:prenom_noms ,
    date_debut: {date: d, mois:moi},
    profession: membre_profession.value,
    montant_mois: [{valeur:0, id:d, mois:moi }],
    montant_cotise: 0,
    montant_restant: membre_seuil.value,
    montant_depart_total: membre_seuil.value,
     email: membre_email.value,
      isDisabled:false,

  })

  affichage_utilisateur()

 
} catch (e) {
  console.error("Error adding document: ", e);
}
}

                                                        // PARTIE ARCHIVE

window.btn_archive= async function(id){

let tab= todo.filter(item=> item.id == id)
console.log(tab[0].date_debut)

try{
await addDoc(formulaire_archive,{
        prenom_nom:tab[0].prenom_nom ,
        naissance: tab[0].naissance,
        profession:tab[0].profession,
        email: tab[0].email,
        telephone: tab[0].telephone,
        date_debut: tab[0].date_debut,
        seuil: tab[0].seuil,
        progression: tab[0].progression,      
        adresse: tab[0].adresse,
        organisation: tab[0].organisation,
      progress_bar3:tab[0].progress_bar3,    
   });
 console.log("fallou")
 
}
catch (e) {
  console.error("Error adding document: ", e);
}

     
await deleteDoc(doc(db, "formulaire_ajouter", id));
 todo = todo.filter(toto1 => toto1.id !== id);
            affichage_utilisateur()  ; // Met à jour l'affichage

}

function affichage_archive(){
        if (todo2.length>0) {
let element = "";
    const start = (currentPage - 1) * itemsPerPage;
    const end = start + itemsPerPage;
    const paginatedItems = todo2.slice(start, end);
    console.log(paginatedItems)



    paginatedItems.forEach(item => {
              element += `
            

            <tr class="text-center"> 
                <td>
                   ${item.prenom_nom} 
                                    
                 </td>
                 <td>${item.date_debut.date} </td>
                 <td>
                   <div class="">
                        <button  type="button" class="border-0  bg-white"  >
                            <i class="bi bi-eye"></i>
                        </button>
                         <button type="button" class="border-0 bg-white" onclick="btn_desarchive('${item.id}')"  >
                            <i class="bi bi-archive" ></i>
                        </button>
                        
                    </div>

                </td>  
             </tr>
        `;
    });
    archive.innerHTML=element;

}
para_archive.innerHTML= todo2.length +" Membres Archivés"


}

                                                // PARTIE Bloque

window.btn_bloque= async function(id){
let tab = todo.filter(item=>item.id==id)
try{
await addDoc(formulaire_bloque,{
        prenom_nom:tab[0].prenom_nom ,
        naissance: tab[0].naissance,
        profession:tab[0].profession,
        email: tab[0].email,
        telephone: tab[0].telephone,
        date_debut: tab[0].date_debut,
        seuil: tab[0].seuil,
        progression: tab[0].progression,      
        adresse: tab[0].adresse,
        organisation: tab[0].organisation,
      progress_bar3:tab[0].progress_bar3,    
   });
 console.log("fallou")
 
}
catch (e) {
  console.error("Error adding document: ", e);
}
affichage_bloque()
    
}


function affichage_bloque(){

        if (todo3.length>0) {
let element = "";
    const start = (currentPage - 1) * itemsPerPage;
    const end = start + itemsPerPage;
    const paginatedItems = todo3.slice(start, end);
    console.log(paginatedItems)



    paginatedItems.forEach(item => {
              element += `
            

            <tr class="text-center"> 
                <td>
                   ${item.prenom_nom} 
                                    
                 </td>
                 <td>${item.date_debut.date} </td>
                 <td>
                   <div class="">
                        <button  type="button" class="border-0  bg-white"  >
                            <i class="bi bi-eye"></i>
                        </button>
                         <button type="button" class="border-0 bg-white" onclick="btn_debloquer('${item.id}')"  >
                            <i class="bi bi-archive" ></i>
                        </button>
                        
                    </div>

                </td>  
             </tr>
        `;
    });
    bloque.innerHTML=element;

}
para_bloque.innerHTML= todo3.length +" Membres Bloqués"
    


}




                                                // Partie DESARCHIVE

window.btn_desarchive= async function(id){
 let tab= todo2.filter(item=>item.id==id)
 try{
    await  addDoc(formulaire_membre,{
        prenom_nom:tab[0].prenom_nom ,
        naissance: tab[0].naissance,
        profession:tab[0].profession,
        email: tab[0].email,
        telephone: tab[0].telephone,
        date_debut: tab[0].date_debut,
        seuil: tab[0].seuil,
        progression: tab[0].progression,      
        adresse: tab[0].adresse,
        organisation: tab[0].organisation,
      progress_bar3:tab[0].progress_bar3,    
   });
 }
 catch (e) {
  console.error("Error adding document: ", e);
}
    
await deleteDoc(doc(db, "formulaire_archiv", id));
 todo = todo2.filter(toto1 => toto1.id !== id);
           affichage_archive()  ; // Met à jour l'affichage

}


                                        // Partie Cotisation
                


function affichage_cotisation(total2){
     let element = "";
    const start = (currentPage - 1) * itemsPerPage;
    const end = start + itemsPerPage;
    const paginatedItems = todo1.slice(start, end);
    

     paginatedItems.forEach((item)=> {
             
      
        let isDisabled = parseFloat(total2) + parseFloat(cotiser.value) >= parseFloat(item.montant_depart_total);


         element += `
             <tr > 
                <td>
                   ${item.prenom_nom} 
                                    
                 </td>
                 <td>
                  ${item.date_debut.date} 
                  </td>
                   <td>${item.montant_cotise}</td>
                    <td >${item.montant_restant}</td>
                    <td>
                     <div class="">
                        <button  type="button" class="border-0  bg-white"  onclick="btn_voir('${item.id}')"  data-bs-toggle="modal" data-bs-target="#exampleModal2" >
                            <i class="bi bi-eye"></i>
                        </button>
                        <button type="button" class="btn btn-primary ms-auto" data-bs-toggle="modal" data-bs-target="#exampleModal1" id="${item.id}" onclick="btn_cotisation('${item.id}')" ${item.isDisabled ? 'disabled' : ''}>
                    Cotiser
                    </button>
                     </div>
                    </td>
             </tr>
        `;
       
    });
      body1.innerHTML = element;
      total_card()
}

// Ajout de cotisation
async function ajouterCotisation(id, montant, total, montan_rest, total1, disable, utili_id, pourcent, todo2_filter) {
  try {
    let docutili;
    const docRef = doc(db, "formulaire_cotiser", id);
    if (utili_id !== undefined) {
     docutili=doc(db, "formulaire_ajouter", utili_id)
}
    let doc_archive= todo2_filter;
    console.log(doc_archive)
    if (todo2_filter !== undefined) {
     doc_archive= doc(db, "formulaire_archiv", todo2_filter)
 }
    console.log(utili_id)

    const dateActuelle = new Date();
        const jour = dateActuelle.getDate();
        const moisIndex = dateActuelle.getMonth() + 1; // Les mois commencent à 0, donc on ajoute 1
        const annee = dateActuelle.getFullYear();
        const moisNoms = [
         "janvier", "février", "mars", "avril", "mai", "juin",
         "juillet", "août", "septembre", "octobre", "novembre", "décembre"
        ];
        const moi = moisNoms[moisIndex];
        let d= jour+"/"+moisIndex+"/"+annee;
        let termine= "EN cours";
        if (pourcent==100) {
            termine="Términé"
        }
        
    // Met à jour le document avec le montant de la cotisation
     
        

    await updateDoc(docRef, {
      montant_mois:arrayUnion( {valeur: parseFloat(montant), id:d, mois: moi}),
        // date_mois: arrayUnion({date: d, mois:moi, id:}),
      montant_cotise: parseFloat(total) + parseFloat(montant),  
      montant_restant: parseFloat(montan_rest) - parseFloat(montant) ,
         isDisabled: disable 
    });

    if (utili_id !== undefined) {
    await updateDoc(docutili,{
        progress_bar3: pourcent,
        progression:termine
        
    });
}

    if (todo2_filter !== undefined) {
    await updateDoc(doc_archive,{
        progress_bar3: pourcent,
        progression:termine
    })
}

    console.log('Cotisation ajoutée avec succès');
  } catch (error) {
    console.error('Erreur lors de l\'ajout de la cotisation:', error);
  }
}


// Cotisation a envoyer
document.getElementById('valider_cotisation').addEventListener('click', valider)
async function valider() {
    

  if (indice) {
    const champ = document.getElementById('cotiser').value;
     let tab= todo1.filter(item => item.id == indice);

      let total_a_cotisser= tab[0].montant_depart_total;
      let email= tab[0].email;
      console.log(email)
        
      let tab1 = tab.map(item=> item.montant_mois.map(items => {
        return items.valeur;
      }));
   
       const tab_total_cotiser = tab1.reduce((a, b) => {
         return a + b, 0; 
        });

       let total_cotiser= tab_total_cotiser.reduce((a,b)=>a+b)
       console.log(total_cotiser)
      
         let montant_r=  tab[0].montant_restant;

       

     let isDisabled = parseFloat(total_cotiser) + parseFloat(cotiser.value) >= parseFloat(total_a_cotisser);
            

        // PARTIE PROGREESION POURCENTAGE UTILISATEUR     
     let progres_utili= ((parseFloat(total_cotiser) + parseFloat(cotiser.value))/total_a_cotisser) *100
        let poucentage_arrondi=Math.round(progres_utili)

        console.log(progres_utili)

        let filter_todo= todo.filter(item=> item.email==email)

            let filter_id;
            if (filter_todo.length>0) {
          filter_id=filter_todo[0].id
     }
        let utili_bar= document.getElementById(filter_id)
        
        // PARTIE ARCHIVE

        let filter_todo2= todo2.filter(item=> item.email == email)
         let filter_id_todo2;
         if (filter_todo2.length>0) {       
         filter_id_todo2= filter_todo2[0].id
     }
        console.log(filter_id, filter_id_todo2)

         
 
      

    await ajouterCotisation(indice, champ, total_cotiser, montant_r, total_a_cotisser, isDisabled,filter_id, poucentage_arrondi, filter_id_todo2 );
    affichage_cotisation(total_cotiser);  // Actualise l'affichage après la mise à jour
    affichage_utilisateur()
    
    console.log( isDisabled)
    let btn_cotiser= document.getElementById(indice);
    if ( isDisabled) {
            btn_cotiser.disabled=true;
             console.log(btn_cotiser)  
        }
  }
   
        
        
  total_card()
};
   
let indice;

window.btn_cotisation =  function(id) {
  indice = id;
  document.getElementById('cotiser').value=""
};

// Boutton voir partie cotisation

window.btn_voir = async function (id){
    let tab= todo1.filter(item => item.id == id);
    console.log(tab)
    let tab1= tab[0].montant_mois;
    let tab2= tab1.slice(1)
    console.log("montant_mos")
        let element="";
  tab2.forEach(item => {
        element += `
            

            <tr class="text-center " > 
                <td> ${item.mois}</td>
                 <td> ${item.id} </td> 
                   <td>${item.valeur} FCFA</td>
      
             </tr>

        `;
    });

    voir.innerHTML= element;
    voir_nom.innerHTML= tab[0].prenom_nom;
    voir_profession.innerHTML= tab[0].profession;
      let tab3 = tab.map(item=> item.montant_mois.map(items => {
        return items.valeur;
      }));
   
       const tab_total_cotiser = tab3.reduce((a, b) => {
         return a + b, 0; 
        });

       let total_cotiser= tab_total_cotiser.reduce((a,b)=>a+b)

        voir_total.innerHTML= "Total= " + total_cotiser +"FCFA"

}

function total_card(){
    let tab = todo1.map( item=> item.montant_mois)
    console.log(tab)
    if (tab.length>0) {
    let tabprogress= todo1.map(item=> item.montant_cotise)
    
    document.getElementById('total_caisse').innerHTML=tabprogress.reduce((a,b)=> a+b) + " FCFA"
    let montan_arrive=tabprogress.reduce((a,b)=> a+b)
    let progess= todo1.map(item=>item.montant_depart_total)
    let montant_depar= progess.reduce((a,b)=> parseFloat(a)+ parseFloat(b));
    console.log(montan_arrive, montant_depar)

    let pourcentage= (montan_arrive / parseFloat(montant_depar)) *100;
    
    let poucentage_arrondi=Math.round(pourcentage);

    let progress_bar=document.getElementById('progress_bar')
    progress_bar.style.width = poucentage_arrondi + '%'
   

    document.getElementById('seuil_pourcentage').innerHTML=poucentage_arrondi + "% du seuil"



    let tab1= tab.map(item=> item[item.length-1])
    console.log(tab1)
    
    let tab2= tab1.reduce((a, b) => {
    return a + b.valeur;
    }, 0);
     montant_dernier_moi.innerHTML= tab2;

   
   document.getElementById('para_moi').innerHTML=tab1[0].mois;
     


    if (tab1.map(item=> item>=2)) {
    let tab4= tab.filter(item =>  item.length>=2 );
    console.log(tab4)
    let tab6=tab4.map(item=> item[item.length-2])
     console.log(tab6)
     let tab5= tab6.reduce((a, b) => {
    return a + b.valeur;
    }, 0);
     console.log(tab5)
     montant_adernier_moi.innerHTML=tab5;
     if (tab6.length>0) {
   document.getElementById('para_amoi').innerHTML=tab6[0].mois
}

else{
    display_card.setAttribute('class', 'd-none')
}
         
     
}

}

}





//ajout des information de l'admin

// appel des variables de parametre generaux1
let prenom1 = document.getElementById("inputPrenom");
let nom1 = document.getElementById("inputNom");
let statut1 = document.getElementById("inputStatut");
let mail1 = document.getElementById("inputEmail");

// appel des variables de parametre genereaux
let prenom2 = document.getElementById("info1");
let nom2 = document.getElementById("info2");
let statut2 = document.getElementById("info3");
let mail2 = document.getElementById("info4");
let info = document.getElementById("info5")
let infos = document.getElementById("info6")

let bouton = document.getElementById("btn-jour");

bouton.addEventListener("click",(e)=>{
    e.preventDefault();
    prenom2.innerHTML = prenom1.value;
    nom2.innerHTML = nom1.value
    statut2.innerHTML = statut1.value;
    mail2.innerHTML = mail1.value
    info.innerHTML=prenom1.value + " " + nom1.value;
    infos.innerHTML=statut1.value;
    console.log(prenom2,nom2);
        // Add a new document with a generated id.
        const docRef =  addDoc(collection(db, "admin"), {
  name: prenom1.value,
  lastname:nom1.value,
  status:statut1.value,
  email:mail1.value
})
console.log("Document written with ID: ", docRef.id);
    

// recuperation des infons admin
recupererDonnees();
});
async function recupererDonnees() {
    const querySnapshot = await getDocs(collection(db, "admin"));
    querySnapshot.forEach((doc) => {
        const data = doc.data();


        prenom2.innerHTML =data.name;
        nom2.innerHTML =data.lastname;
        statut2.innerHTML=data.status;
        mail2.innerHTML = data.email;
        info.innerHTML=data.name + " " +data.lastname;
        infos.innerHTML=data.status;


    });
}

// Appel de la fonction pour récupérer les données
recupererDonnees();





</script>
</html>