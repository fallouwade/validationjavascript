<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title></title>
	 <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
        <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>

	<section class="container-fluid">
		<div class="row gap-5">
			<div class="col-md-4 col-12  bg-success rounded-end-5">
				
			</div>
			<div class="col-md-7 col-12 ms-5 ps-5">
				<p class=" fst-normal para">Bienvenue sur Bakéli-tontine</p>
				<p class="text-center para_connect">Connecter-vous</p>
				<p>Connecter-vous et gérez vos cotisations</p>
				<div class="text-center">
					<form id="formulaire">
					<div class="mb-3 col-4 text-center">
                        
                         <input type="text" class="form-control bg-success text-white " placeholder="N° téléphone" required id="connect_num" >
                    </div>
                    <div class="mb-3 col-4">
                        
                         <input type="text" class="form-control bg-success text-white" placeholder="Mot de passe" required id="connect_password">
                         <small id="message_erreur"></small>
                    </div>
					</form>
					<div>
						<a href="#">Mot de passe oublié?</a>
					</div>
					
					<div>
						<button class="btn btn-success" id="btn_connexion">Connexion</button>
					</div>
				</div>
				<p>Vous n'avez pas de compte,<a href="inscription.html" class="text-decoration-none text-black">inscrivez-vous!</a> </p>
			</div>
		</div>
	</section>

	<script type="module">
		 // Import the functions you need from the SDKs you need
 import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
  import { getFirestore } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js";
import {collection, addDoc, getDocs,doc,deleteDoc, onSnapshot, updateDoc} from "https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCZypuK23zcCrMuOoMjlOKt5Ay7gQz8ZOc",
  authDomain: "validdationjs.firebaseapp.com",
  projectId: "validdationjs",
  storageBucket: "validdationjs.appspot.com",
  messagingSenderId: "609699792407",
  appId: "1:609699792407:web:84a8dbfcb4f6b8b33e7e52"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);


// Recupération des donnés aux niveaux de firebase
const formulaire_inscri = collection(db, "formulaire_inscription")
let todo=[]
 async function recuperation() {
            try {
                const snapshot = await getDocs(formulaire_inscri);
                snapshot.docs.forEach(doc => {
                     todo.push({ ...doc.data(), id: doc.id });
                    console.log(todo)
                });
                onSnapshot(formulaire_inscri, (snap) => {
                    todo = [];
                    snap.docs.forEach((doc) => {
                        todo.push({ ...doc.data(), id: doc.id });
                    });
                
                });
                
            }
             catch (e) {
                console.error("Erreur: ", e);
            }
        }
        recuperation();
       btn_connexion.addEventListener( 'click', function (e){
    		e.preventDefault() 
        	todo.forEach((e)=> {
        		console.log(e)
        		if (e.telephone == connect_num.value.trim() && e.mot_de_pass == connect_password.value.trim() ) {
        		formulaire.reset()
               window.location.href= "acueil.html"
        			console.log("fallou")

        		}
        		else{
        			message_erreur.innerHTML="Numéro de telephone ou mot de passe invalid";        
        			message_erreur.classList.add('text-danger');
        		}
        	})

       	
        });
       

	</script>

</body>
</html>